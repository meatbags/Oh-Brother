var Brother=function(t){function e(r){if(i[r])return i[r].exports;var s=i[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=e.Canvas=e.Loader=void 0;var s=i(1),n=r(s),a=i(2),h=r(a),o=i(3),l=r(o);e.Loader=n.default,e.Canvas=h.default,e.Parser=l.default},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){this.image=new Image,this.onload=null};r.prototype={load:function(t){this.image.onload=this.onload,this.image.src=t},getImageRaw:function(){return this.image}},e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){this.init()};r.prototype={init:function(){this.cvs={helper:document.createElement("canvas"),preview:document.createElement("canvas")},this.ctx={helper:this.cvs.helper.getContext("2d"),preview:this.cvs.preview.getContext("2d")},this.scale=3},drawImage:function(t){var e=this.ctx.helper,i=this.cvs.helper;i.width=t.width,i.height=t.height,e.clearRect(0,0,i.width,i.height),e.drawImage(t,0,0)},drawGrid:function(t){if(t>=2){var e=this.cvs.helper,i=this.ctx.helper;i.fillStyle="rgba(255, 255, 255, 0.25)";for(var r=0;r<e.width;r+=t)i.fillRect(r,0,1,e.height);for(var s=0;s<e.height;s+=t)i.fillRect(0,s,e.width,1)}},drawProcessed:function(t){var e=this.ctx.preview,i=this.cvs.preview,r=t.data;i.width=t.columns*this.scale,i.height=t.rows*this.scale,e.clearRect(0,0,i.width,i.height),e.fillStyle="#000";for(var s=0;s<r.length;s+=1)if(1==r[s]){var n=s%t.columns*this.scale,a=Math.floor(s/t.columns)*this.scale;e.fillRect(n,a,this.scale,this.scale)}},getHelperCanvas:function(){return this.cvs.helper},getPreviewCanvas:function(){return this.cvs.preview}},e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7),s=function(t){return t&&t.__esModule?t:{default:t}}(r),n=function(){this.needsUpdate=!0,this.loaded=!1,this.brother=new s.default,this.init()};n.prototype={init:function(){this.threshold=50,this.stretch=1,this.threadcount=200,this.size=10,this.data=[],this.result={}},imageToPixelArray:function(t){this.data=[],this.image=t;var e=document.createElement("canvas"),i=e.getContext("2d");e.width=t.width,e.height=t.height,i.drawImage(t,0,0);for(var r=i.getImageData(0,0,t.width,t.height).data,s=0;s<r.length;s+=4)this.data.push({r:r[s],g:r[s+1],b:r[s+2]});this.fitToImage(),this.loaded=!0},fitToImage:function(){this.size=this.image.width/this.threadcount,this.needsUpdate=!0},setSize:function(t){this.size=t,this.threadcount=Math.min(200,Math.floor(this.image.width/this.size)),this.needsUpdate=!0},setStretch:function(t){this.stretch=t,this.result.stretch=this.stretch,this.needsUpdate=!0},setThreshold:function(t){this.threshold=t,this.needsUpdate=!0},setThreadcount:function(t){this.threadcount=t,this.needsUpdate=!0},getBrightness:function(t){return(t.r+t.g+t.b)/3},process:function(){var t=this.size/this.stretch,e=Math.floor(this.image.height/t);this.result={rows:e,columns:this.threadcount,data:[]};for(var i=0;i<e;i+=1)for(var r=0;r<this.threadcount;r+=1){for(var s=0,n=0,a=Math.floor(r*this.size+Math.floor(i*t)*this.image.width),h=0;h<this.size;h+=1)for(var o=0;o<t;o+=1){var l=a+h+o*this.image.width;l<this.data.length&&(s+=this.getBrightness(this.data[l]),n+=1)}s=0!=n?s/n/255*100:0;var c=s>=this.threshold?0:1;this.result.data.push(c)}this.needsUpdate=!1},save:function(t){if(!this.result.data)throw"Error: No data";var e=this.brother.convert(this.result.data,this.result.rows,this.result.columns),i=new Blob([e],{type:"application/octet-stream"});saveAs(i,t)}},e.default=n},,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){};r.prototype={convert:function(t,e,i){var r=Math.ceil(e/2),s=Math.ceil(i/4),n=Math.ceil(s*e/2),a=4*s*e%8!=0,h=4*s-i;console.log("Rows:",e,"Stitches:",i,"Data Size:",t.length),console.log("Memo Bytes:",r,"Data Bytes:",n,"Row Nibbles:",s,"Pad Data:",a,"Row Padding:",h);for(var o=new Uint8Array(r),l=new Uint8Array(n),c=new Uint8Array(32768),d=a?4:0,u=0;u<t.length;u+=1){var f=1;u%i==0&&(f+=h,d+=h);var g=Math.floor(d/8);l[g]<<=f,l[g]|=t[u],d+=1}this.logSampleHex(l);for(var v=32479,w=o.length+l.length,p=o.length-1;p>-1;p-=1)c[v]=o[p],v-=1;for(var m=l.length-1;m>-1;m-=1)c[v]=l[m],v-=1;return this.writeHeaders(c,e,i),this.writeConstants(c,120,w),c},copyValue:function(t,e,i,r){for(;i>0;)i-=1,t[e+i]=r},writeIndex:function(t,e,i,r){for(var s=0;i>0;)i-=1,t[e+s]=r>>8*i&255,s+=1},decimalToNibble3:function(t){return((255&Math.floor(t/100))<<8)+((255&Math.floor(t%100/10))<<4)+(t%10&255)},writeHeaders:function(t,e,i){var r=this.decimalToNibble3(120),s=this.decimalToNibble3(e),n=this.decimalToNibble3(i),a=(s<<12)+n,h=this.decimalToNibble3(901);this.writeIndex(t,0,2,r),this.writeIndex(t,2,3,a),this.writeIndex(t,5,2,h),console.log("Offset:",r.toString(16),"Height, Width:",s.toString(16),n.toString(16),"Num:",h.toString(16))},writeConstants:function(t,e,i){var r=e+i,s=e+i-1;this.copyValue(t,32480,7,85),this.copyValue(t,32487,25,0),this.writeIndex(t,32512,2,r),this.writeIndex(t,32514,2,1),this.writeIndex(t,32516,2,r),this.writeIndex(t,32518,2,e),this.writeIndex(t,32520,2,0),this.writeIndex(t,32522,2,s),this.writeIndex(t,32524,4,33024),this.writeIndex(t,32528,2,32761),this.writeIndex(t,32530,2,0),this.writeIndex(t,32532,3,0),this.copyValue(t,32535,25,0),this.copyValue(t,32560,186,0),this.copyValue(t,32748,19,0),this.writeIndex(t,32746,2,6401),this.writeIndex(t,32767,1,2)},logSampleHex:function(t){for(var e="SAMPLE: ",i=0;i<t.length&&i<16;i+=1){e+=t[i].toString(16)+" "}console.log(e)}},e.default=r}]);